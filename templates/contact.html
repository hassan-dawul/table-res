{% extends "base.html" %}

{% block title %}ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§{% endblock %}

{% block content %}
<main class="container py-5" style="max-width: 600px;">
    <h1 id="contact-title" class="text-center mb-4">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h1>
    <p id="contact-intro" class="text-center mb-4">Ø¥Ø°Ø§ Ø¹Ù†Ø¯Ùƒ Ø³Ø¤Ø§Ù„ Ø£Ùˆ Ø§Ù‚ØªØ±Ø§Ø­ØŒ Ø§ÙƒØªØ¨ Ù„Ù†Ø§ ÙˆØ³Ù†Ø±Ø¯ Ø¨Ø£Ù‚Ø±Ø¨ ÙˆÙ‚Øª.</p>

    <form id="contactForm">
        <div class="mb-3">
            <label for="name" id="label-name" class="form-label">Ø§Ù„Ø§Ø³Ù…</label>
            <input type="text" class="form-control" id="name" placeholder="Ø§Ù„Ø§Ø³Ù…" required>
        </div>

        <div class="mb-3">
            <label for="email" id="label-email" class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
            <input type="email" class="form-control" id="email" placeholder="you@gmail.com" required>
        </div>

        <div class="mb-3">
            <label for="subject" id="label-subject" class="form-label">Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</label>
            <input type="text" class="form-control" id="subject" placeholder="Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø©" required>
        </div>

        <div class="mb-3">
            <label for="message" id="label-message" class="form-label">Ø§Ù„Ø±Ø³Ø§Ù„Ø©</label>
            <textarea class="form-control" id="message" rows="5" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." required></textarea>
        </div>

        <button type="submit" id="send-btn" class="btn btn-primary w-100 py-2">Ø¥Ø±Ø³Ø§Ù„</button>
        <div id="formMessage" class="mt-3 text-center text-danger"></div>
    </form>
</main>

<!-- Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù€ placeholder Ø§Ù„Ù…Ø®ÙÙŠØ© -->
<p class="d-none" id="namePlaceholder">Ø§Ù„Ø§Ø³Ù…</p>
<p class="d-none" id="subjectPlaceholder">Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø©</p>
<p class="d-none" id="messagePlaceholder">Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§...</p>


<script>
    $(document).ready(function() {

    // Ø§Ù„Ø§Ø³Ù…
    var nameInput = document.getElementById("name");
    const namePlaceholder = document.getElementById("namePlaceholder")?.textContent || "Ø§Ù„Ø§Ø³Ù…";
    nameInput.placeholder = namePlaceholder;

    // Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹
    var subjectInput = document.getElementById("subject");
    const subjectPlaceholder = document.getElementById("subjectPlaceholder")?.textContent || "Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø©";
    subjectInput.placeholder = subjectPlaceholder;

    // Ø§Ù„Ø±Ø³Ø§Ù„Ø©
    var messageInput = document.getElementById("message");
    const messagePlaceholder = document.getElementById("messagePlaceholder")?.textContent || "Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§...";
    messageInput.placeholder = messagePlaceholder;

    // ğŸ”¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„ÙÙˆØ±Ù…
    const contactForm = document.getElementById('contactForm');
    const formMessage = document.getElementById('formMessage');

    contactForm.addEventListener('submit', async (e) => {
        e.preventDefault();


    const lang = localStorage.getItem('site-lang') || 'ar';


        const formData = {
            name: document.getElementById('name').value,
            email: document.getElementById('email').value,
            subject: document.getElementById('subject').value,
            message: document.getElementById('message').value,
            lang: lang  // Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹

        };

        try {
            const response = await fetch('/contact', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(formData)
            });

            const data = await response.json();

            if(response.ok) {
                formMessage.classList.remove('text-danger');
                formMessage.classList.add('text-success');
                formMessage.innerText = data.message || 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­!';
                contactForm.reset();
            } else {
                formMessage.classList.remove('text-success');
                formMessage.classList.add('text-danger');
                formMessage.innerText = data.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„';
            }

        } catch (err) {
            formMessage.classList.remove('text-success');
            formMessage.classList.add('text-danger');
            formMessage.innerText = 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…';
        }
    });
});
</script>
{% endblock %}
